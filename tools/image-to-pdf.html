<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Image to PDF Converter | ToolMancer</title>
  <link rel="stylesheet" href="../style.css"/>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;800&display=swap" rel="stylesheet">
  <style>
    /* Add specific styles here or update style.css for tool layouts */
    .tool-page { display: block; } /* Override default tool-page centering for complex layout */
    .pdf-tool-flex { display: flex; flex-wrap: wrap; gap: 2.2rem; justify-content: center; align-items: flex-start; margin-top: 1.3rem;}
    .pdf-images, .pdf-options { background: var(--card); border-radius: 18px; box-shadow: 0 3px 24px var(--card-shadow, rgba(0,0,0,0.05)); border: 1px solid var(--border-color); }
    [data-theme="dark"] .pdf-images, [data-theme="dark"] .pdf-options { box-shadow: 0 3px 24px rgba(0,0,0,0.1); }
    .pdf-images { padding: 1.3rem 1.1rem; min-width: 340px; max-width: 420px; flex: 2 1 380px; text-align: center; position: relative; }
    .pdf-options { padding: 1.4rem 1.1rem 1.1rem 1.1rem; min-width: 220px; max-width: 350px; flex: 1 1 220px; display: flex; flex-direction: column; gap: 1.2em;}

    /* === UI Refinements based on feedback === */
    /* Adjust padding and size for a cleaner look for the drop zone */
    .upload-drop-zone {
      border: 2.5px dashed var(--accent);
      border-radius: 12px;
      background: var(--bg);
      text-align: center;
      transition: border-color 0.2s, background 0.2s;
      padding: 1.5rem 1rem; /* Reduced padding from 2.7em */
      margin-bottom: 1rem; /* Reduced margin from 1.2em */
      cursor: pointer;
      position: relative;
      font-size: 1.13em;
      color: var(--text);
      min-height: 140px;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      box-shadow: 0 1.5px 8px #0000;
    }
    .upload-drop-zone:hover, .upload-drop-zone.active { border-color: var(--accent); background: #e0ebff; }
    [data-theme="dark"] .upload-drop-zone:hover, [data-theme="dark"] .upload-drop-zone.active { background: #334155; }
    .upload-drop-zone .add-icon { font-size: 2em; /* Reduced icon size */ color: var(--accent); margin-bottom: 0.35em; pointer-events: none; }
    .upload-drop-zone .drop-hint { font-size:0.97em;color:var(--text);margin-top:0.5em;}
    /* === END UI Refinements === */

    .img-list { display: flex; flex-direction: column; align-items: center; gap: 1.1em; margin-top: 1em; margin-bottom: 0.9em;}
    .img-item { display: flex; flex-direction: row; align-items: center; gap: 1em; background: var(--bg); border-radius: 12px; box-shadow: 0 1px 6px #0001; padding: 0.6em 0.7em; width: 95%; max-width: 390px; position: relative;}
    [data-theme="dark"] .img-item { background: #475569; }
    .img-thumb { border-radius: 10px; box-shadow: 0 1px 6px #0002; border: 1.5px solid var(--border-color); width: 60px; background: #fafaff; display: block;}
    .img-handle { cursor: grab; font-size: 1.5em; color: #aaa; margin-right: 0.2em;}
    .img-filename { font-size: 0.97em; color: var(--text); max-width: 135px; overflow-x: auto;}
    .img-remove-btn { background: #ef4444; color: #fff; border: none; border-radius: 6px; padding: 0.2em 0.68em; font-size: 1.15em; margin-left: 0.8em; cursor: pointer;}
    .img-remove-btn:hover { background: #c81e1e;}
    .img-list.empty { color: #888; font-size: 1.1em; margin-top: 2em;}
    @media (max-width: 900px) {
      .pdf-tool-flex { flex-direction: column; gap: 1.2rem; align-items: stretch;}
      .pdf-images, .pdf-options { max-width: 99vw; margin: 0 auto;}
      .img-item { width: 100%; }
    }
    @media (max-width: 600px) {
      .pdf-images, .pdf-options { min-width: unset; }
      .img-thumb { width: 38px; }
      .img-filename { font-size: 0.92em; max-width: 70px;}
    }
    /* PDF Options Buttons */
    .pdf-opt-label { font-size: 0.95em; color: #475569; margin-bottom: 0.5em; font-weight: 500; }
    [data-theme="dark"] .pdf-opt-label { color: #94a3b8; }
    .pdf-opt-group { display: flex; gap: 0.5rem; }
    .pdf-opt-btn, .pdf-main-btn { padding: 0.7rem 1rem; border-radius: 8px; font-weight: 600; cursor: pointer; border: 1px solid var(--border-color); transition: background 0.2s; background: var(--card); color: var(--text); }
    .pdf-opt-btn.active { background: var(--accent); color: white; border-color: var(--accent); }
    .pdf-main-btn { background: var(--accent); color: white; border: none; margin-top: 1rem; width: 100%; font-size: 1.1rem; }
    .pdf-opt-dropdown { width: 100%; padding: 0.7rem; border-radius: 8px; border: 1px solid var(--border-color); background: var(--bg); color: var(--text); }
    .pdf-checkbox { width: 18px; height: 18px; }

    /* Centering Fix */
    main { display: flex; justify-content: center; align-items: center; min-height: calc(100vh - var(--header-height) - 100px); }
    .tool-page { display: flex; flex-direction: column; align-items: center; justify-content: center; width: 100%; max-width: 1280px; padding: 2rem; }
    .tool-card { width: 100%; }
  </style>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Sortable/1.15.0/Sortable.min.css"/>
</head>
<body>

  <header class="main-header">
    <a href="../index.html" class="logo">ToolMancer</a>
    <nav class="main-nav">
      <ul>
        <li><a href="../index.html#category-image">Image Tools</a></li>
        <li><a href="../index.html#category-text">Text Tools</a></li>
        <li><a href="../blog.html">Blog</a></li>
      </ul>
      <button class="search-btn" id="searchBtn" aria-label="Search"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line></svg></button>
      <button class="all-tools-btn" id="allToolsBtn">All Tools <span class="arrow">‚ñº</span></button>
      <button id="theme-toggle" class="theme-btn" aria-label="Toggle dark mode">üåô</button>
      <button class="hamburger-btn" id="hamburgerBtn">‚ò∞</button>
    </nav>
  </header>

  <div class="mega-menu" id="allToolsMenu">
    <div class="mega-menu-grid">
      <div class="mega-menu-category">
        <h3>Image Tools</h3>
        <ul>
            <li><a href="image-to-pdf.html"><span class="tool-icon">üìÑ</span> Image to PDF</a></li>
            <li><a href="image-compressor.html"><span class="tool-icon">üóúÔ∏è</span> Image Compressor</a></li>
            <li><a href="image-resizer.html"><span class="tool-icon">üìè</span> Image Resizer</a></li>
            <li><a href="convert-png-jpg.html"><span class="tool-icon">üñºÔ∏è</span> PNG <> JPG</a></li>
            <li><a href="steganography.html"><span class="tool-icon">üïµÔ∏è</span> Steganography</a></li>
        </ul>
      </div>
      <div class="mega-menu-category">
          <h3>Text & Writing</h3>
          <ul>
              <li><a href="text-diff.html"><span class="tool-icon">üîç</span> Text Diff</a></li>
              <li><a href="text-encryptor.html"><span class="tool-icon">üîê</span> Text Encryptor</a></li>
              <li><a href="text-to-pdf.html"><span class="tool-icon">üìÑ</span> Text to PDF</a></li>
              <li><a href="word-counter.html"><span class="tool-icon">‚úèÔ∏è</span> Word Counter</a></li>
          </ul>
      </div>
      <div class="mega-menu-category">
          <h3>Converters</h3>
          <ul>
              <li><a href="unit-converter.html"><span class="tool-icon">‚öñÔ∏è</span> Unit Converter</a></li>
              <li><a href="document-scanner.html"><span class="tool-icon">üìë</span> Document Scanner</a></li>
          </ul>
      </div>
      <div class="mega-menu-category">
          <h3>Encoder/Decoder</h3>
          <ul>
              <li><a href="url-encoder.html"><span class="tool-icon">üîó</span> URL Encoder</a></li>
              <li><a href="hash-generator.html"><span class="tool-icon">üõ°Ô∏è</span> Hash Generator</a></li>
              <li><a href="password-generator.html"><span class="tool-icon">üîë</span> Password Generator</a></li>
              <li><a href="qr-generator.html"><span class="tool-icon">üì±</span> QR Generator</a></li>
          </ul>
      </div>
      <div class="mega-menu-category">
          <h3>AI Tools</h3>
          <ul>
              <li><a href="image-to-prompt.html"><span class="tool-icon">ü§ñ</span> Image to Prompt</a></li>
              <li><a href="json-formatter.html"><span class="tool-icon">üß©</span> JSON Formatter</a></li>
          </ul>
      </div>
    </div>
  </div>

  <div class="search-overlay" id="searchOverlay">
    <button class="search-close-btn" id="searchCloseBtn" aria-label="Close Search">&times;</button>
    <div class="search-box">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line></svg>
        <input type="text" id="searchInput" placeholder="Search for a tool..." autocomplete="off">
    </div>
    <div id="search-results"></div>
  </div>

  <main class="content tool-page">
    <section class="tool-card">
      <header class="tool-header">
        <h1>üñºÔ∏è Image to PDF Converter</h1>
        <div class="tool-desc">Convert multiple images (JPG, PNG, etc.) into a single PDF ‚Äî privacy-friendly, works in your browser. Drag, reorder, and customize PDF output!</div>
        <span class="tool-help" title="Upload images, reorder, set options, and convert to PDF. Nothing leaves your device!">i</span>
      </header>
      <div class="pdf-tool-flex">
        <!-- Image area -->
        <div class="pdf-images" id="pdfImages">
          <div class="upload-drop-zone" id="dropZone">
            <span class="add-icon">+</span>
            <span style="font-weight:500;">Add images or drag & drop</span>
            <input type="file" id="imgInput" accept="image/*" multiple>
            <div class="drop-hint">Supported: JPG, PNG, WebP...</div>
          </div>
          <div class="img-list" id="imgList"></div>
          <div id="noImgMsg" class="img-list empty">No images selected</div>
        </div>
        <!-- PDF options panel -->
        <form class="pdf-options" id="pdfOptions" onsubmit="return false;">
          <div>
            <div class="pdf-opt-label">Page orientation</div>
            <div class="pdf-opt-group">
              <button type="button" class="pdf-opt-btn active" data-orient="portrait" id="orientPortrait">Portrait</button>
              <button type="button" class="pdf-opt-btn" data-orient="landscape" id="orientLandscape">Landscape</button>
            </div>
          </div>
          <div>
            <div class="pdf-opt-label">Page size</div>
            <select class="pdf-opt-dropdown" id="pageSize">
              <option value="a4">A4 (297x210 mm)</option>
              <option value="letter">Letter (279x216 mm)</option>
              <option value="legal">Legal (356x216 mm)</option>
            </select>
          </div>
          <div>
            <div class="pdf-opt-label">Margin</div>
            <div class="pdf-opt-group">
              <button type="button" class="pdf-opt-btn active" data-margin="none" id="marginNone">No margin</button>
              <button type="button" class="pdf-opt-btn" data-margin="small" id="marginSmall">Small</button>
              <button type="button" class="pdf-opt-btn" data-margin="big" id="marginBig">Big</button>
            </div>
          </div>
          <div>
            <input type="checkbox" class="pdf-checkbox" id="mergeAll" checked/>
            <label for="mergeAll" style="font-size:1.05em;">Merge all images in one PDF file</label>
          </div>
          <button class="pdf-main-btn" id="convertBtn" disabled>
            Convert to PDF <span style="font-size:1.2em;">‚ûî</span>
          </button>
        </form>
      </div>
      <section class="result-box" id="resultBox" style="display:none; text-align: center; margin-top: 2rem;">
        <h3>Result:</h3>
        <a id="downloadBtn" class="btn" download="output.pdf">‚¨áÔ∏è Download PDF</a>
        <button id="openBtn" class="btn">üîó Open in New Tab</button>
        <button id="copyLinkBtn" class="btn">üìã Copy Link</button>
      </section>
    </section>
    <section class="how-to">
      <h3>How to Use</h3>
      <ol>
        <li>Click anywhere in the box or drag & drop images.</li>
        <li>Reorder if needed, set options.</li>
        <li>Click <b>Convert to PDF</b>.</li>
        <li>Download or open your PDF.</li>
      </ol>
    </section>
    <section class="use-case">
      <h3>Example</h3>
      <p><b>Input:</b> 3 PNG images (receipts)<br>
         <b>Output:</b> 1 PDF file containing all three pages</p>
    </section>
  </main>

  <footer class="main-footer">
    <ul class="footer-links">
        <li><a href="../about.html">About Us</a></li>
        <li><a href="../contact.html">Contact</a></li>
        <li><a href="../blog.html">Blog</a></li>
        <li><a href="../privacy.html">Privacy Policy</a></li>
        <li><a href="../disclaimer.html">Disclaimer</a></li>
    </ul>
    <p class="footer-copyright">&copy; 2025 ToolMancer. All Tools Run in Your Browser.</p>
  </footer>

  <script src="../theme.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/Sortable/1.15.0/Sortable.min.js"></script>
  <script>
    document.addEventListener('DOMContentLoaded', () => {
        // --- Navigation and Theme Toggle Logic (Copied from index.html) ---
        const allToolsBtn = document.getElementById('allToolsBtn');
        const hamburgerBtn = document.getElementById('hamburgerBtn');
        const allToolsMenu = document.getElementById('allToolsMenu');
        const searchBtn = document.getElementById('searchBtn');
        const searchCloseBtn = document.getElementById('searchCloseBtn');
        const searchOverlay = document.getElementById('searchOverlay');
        const searchInput = document.getElementById('searchInput');

        const toggleMenu = (event) => { event.stopPropagation(); allToolsMenu.classList.toggle('show'); allToolsBtn.classList.toggle('open'); };
        allToolsBtn.addEventListener('click', toggleMenu);
        hamburgerBtn.addEventListener('click', toggleMenu);
        document.addEventListener('click', (event) => {
            if (allToolsMenu.classList.contains('show') && !allToolsMenu.contains(event.target) && !event.target.closest('.main-nav')) {
                allToolsMenu.classList.remove('show'); allToolsBtn.classList.remove('open');
            }
        });

        searchBtn.addEventListener('click', () => { searchOverlay.classList.add('show'); document.body.classList.add('search-open'); searchInput.focus(); });
        const closeSearch = () => { searchOverlay.classList.remove('show'); document.body.classList.remove('search-open'); searchInput.value = ''; };
        searchCloseBtn.addEventListener('click', closeSearch);

        // --- PDF Tool Specific Logic ---
        const dropZone = document.getElementById('dropZone');
        const imgInput = document.getElementById('imgInput');
        const imgList = document.getElementById('imgList');
        const noImgMsg = document.getElementById('noImgMsg');
        const convertBtn = document.getElementById('convertBtn');
        const resultBox = document.getElementById('resultBox');
        const downloadBtn = document.getElementById('downloadBtn');
        const openBtn = document.getElementById('openBtn');
        const copyLinkBtn = document.getElementById('copyLinkBtn');
        let pdfBlobUrl = '';
        let images = [];

        // Full box click
        dropZone.addEventListener('click', (e) => {
          if (e.target === imgInput) return;
          imgInput.click();
        });
        // Drag & drop
        dropZone.addEventListener('dragover', e => {
          e.preventDefault();
          dropZone.classList.add('active');
        });
        dropZone.addEventListener('dragleave', () => dropZone.classList.remove('active'));
        dropZone.addEventListener('drop', e => {
          e.preventDefault();
          dropZone.classList.remove('active');
          handleFiles(e.dataTransfer.files);
        });
        imgInput.addEventListener('change', e => handleFiles(e.target.files));

        function handleFiles(files) {
          let filesArr = Array.from(files);
          filesArr.forEach(f => {
            if (f.type.startsWith("image/")) images.push({file: f, name: f.name, url: URL.createObjectURL(f)});
          });
          renderImages();
        }
        function renderImages() {
          imgList.innerHTML = '';
          if (!images.length) {
            noImgMsg.style.display = '';
            convertBtn.disabled = true;
            return;
          }
          noImgMsg.style.display = 'none';
          images.forEach((img, i) => {
            let div = document.createElement('div');
            div.className = 'img-item';
            div.setAttribute('data-index', i);
            let handle = document.createElement('span');
            handle.className = 'img-handle';
            handle.innerHTML = '‚ò∞';
            let thumb = document.createElement('img');
            thumb.className = 'img-thumb';
            thumb.src = img.url;
            thumb.title = img.name;
            let fname = document.createElement('div');
            fname.className = 'img-filename';
            fname.textContent = img.name.length > 24 ? img.name.slice(0, 20)+'...' : img.name;
            let removeBtn = document.createElement('button');
            removeBtn.className = 'img-remove-btn';
            removeBtn.textContent = '‚úï';
            removeBtn.title = 'Remove';
            removeBtn.onclick = () => {
              URL.revokeObjectURL(img.url);
              images.splice(i, 1);
              renderImages();
            };
            div.appendChild(handle);
            div.appendChild(thumb);
            div.appendChild(fname);
            div.appendChild(removeBtn);
            imgList.appendChild(div);
          });
          convertBtn.disabled = false;
          makeListSortable();
        }
        function makeListSortable() {
          Sortable.create(imgList, {
            handle: '.img-handle',
            animation: 170,
            onEnd: function (evt) {
              if (evt.oldIndex !== evt.newIndex) {
                const moved = images.splice(evt.oldIndex, 1)[0];
                images.splice(evt.newIndex, 0, moved);
                renderImages();
              }
            }
          });
        }
        // --- PDF Options ---
        let orientation = "portrait";
        let pageSize = "a4";
        let margin = "none";
        document.querySelectorAll(".pdf-opt-btn[data-orient]").forEach(btn => {
          btn.onclick = function() {
            document.querySelectorAll(".pdf-opt-btn[data-orient]").forEach(b=>b.classList.remove('active'));
            this.classList.add('active');
            orientation = this.dataset.orient;
          }
        });
        document.getElementById('pageSize').onchange = function() {
          pageSize = this.value;
        };
        document.querySelectorAll(".pdf-opt-btn[data-margin]").forEach(btn => {
          btn.onclick = function() {
            document.querySelectorAll(".pdf-opt-btn[data-margin]").forEach(b=>b.classList.remove('active'));
            this.classList.add('active');
            margin = this.dataset.margin;
          }
        });
        // --- Convert to PDF ---
        convertBtn.onclick = async function(e) {
          e.preventDefault();
          if (!images.length) return;
          const { jsPDF } = window.jspdf;
          let pdf = new jsPDF({ orientation, unit: "mm", format: pageSize });
          let marginPx = margin === "none" ? 0 : (margin === "small" ? 10 : 24);
          for (let i = 0; i < images.length; i++) {
            if (i > 0 && document.getElementById('mergeAll').checked) pdf.addPage();
            let imgData = await fileToDataUrl(images[i].file);
            let [pw, ph] = [pdf.internal.pageSize.getWidth(), pdf.internal.pageSize.getHeight()];
            let img = new Image();
            img.src = imgData;
            await new Promise(res=>img.onload=res);
            let scale = Math.min((pw - 2*marginPx) / img.width, (ph - 2*marginPx) / img.height);
            let iw = img.width * scale, ih = img.height * scale;
            let ix = (pw-iw)/2, iy = (ph-ih)/2;
            pdf.addImage(img, 'PNG', ix, iy, iw, ih);
            if (!document.getElementById('mergeAll').checked && i < images.length-1) pdf.save(images[i].name.replace(/\.[^/.]+$/, "")+'.pdf');
          }
          if (document.getElementById('mergeAll').checked) {
            let blob = pdf.output('blob');
            if (pdfBlobUrl) URL.revokeObjectURL(pdfBlobUrl);
            pdfBlobUrl = URL.createObjectURL(blob);
            downloadBtn.href = pdfBlobUrl;
            openBtn.onclick = () => window.open(pdfBlobUrl, '_blank');
            copyLinkBtn.onclick = () => {
              navigator.clipboard.writeText(pdfBlobUrl);
              copyLinkBtn.textContent = "‚úÖ Copied!";
              setTimeout(()=>copyLinkBtn.textContent="üìã Copy Link", 1200);
            };
            resultBox.style.display = 'block';
            downloadBtn.click();
          }
        };
        function fileToDataUrl(file) {
          return new Promise((resolve, reject) => {
            const reader = new FileReader();
            reader.onload = e => resolve(e.target.result);
            reader.onerror = reject;
            reader.readAsDataURL(file);
          });
        }
    });
  </script>
</body>
</html>
