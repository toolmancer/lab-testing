<!doctype html><html><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Document Scanner</title><link rel="stylesheet" href="../style.css"></head><body><main class="main"><div class="content container"><h2>Document Scanner</h2><p class="small">Use camera or upload images. Capture pages and save as PDF.</p><input id="files" type="file" accept="image/*" multiple style="margin-top:8px"><br><video id="camera" autoplay playsinline style="display:none;margin-top:8px;width:100%;max-width:480px"></video><div style="margin-top:10px"><button class="btn" id="camBtn">Start Camera</button> <button class="btn" id="capBtn" style="display:none">Capture</button> <button class="btn" id="makePdf">Generate PDF</button></div><div id="thumbs" style="margin-top:12px;display:flex;gap:8px;flex-wrap:wrap"></div></div></main><script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script><script>let stream; const video=document.getElementById('camera'); const caps=[]; document.getElementById('camBtn').addEventListener('click',async ()=>{ if(!stream){ try{ stream = await navigator.mediaDevices.getUserMedia({video:{facingMode:'environment'}}); video.srcObject = stream; video.style.display='block'; document.getElementById('capBtn').style.display='inline-block'; document.getElementById('camBtn').textContent='Stop Camera'; }catch(e){ alert('Camera unavailable'); } } else { stream.getTracks().forEach(t=>t.stop()); stream=null; video.style.display='none'; document.getElementById('capBtn').style.display='none'; document.getElementById('camBtn').textContent='Start Camera'; } }); document.getElementById('capBtn').addEventListener('click', ()=>{ const c=document.createElement('canvas'); c.width=video.videoWidth; c.height=video.videoHeight; c.getContext('2d').drawImage(video,0,0); const d=c.toDataURL('image/png'); caps.push(d); const img=document.createElement('img'); img.src=d; img.style.width='120px'; document.getElementById('thumbs').appendChild(img); }); document.getElementById('files').addEventListener('change', (e)=>{ const files=e.target.files; for(const f of files){ const r=new FileReader(); r.onload=()=>{ caps.push(r.result); const img=document.createElement('img'); img.src=r.result; img.style.width='120px'; document.getElementById('thumbs').appendChild(img); }; r.readAsDataURL(f); } }); document.getElementById('makePdf').addEventListener('click', async ()=>{ const { jsPDF } = window.jspdf; if(caps.length===0){ alert('No pages captured'); return;} const pdf=new jsPDF({unit:'pt',format:'a4'}); for(let i=0;i<caps.length;i++){ const img=new Image(); img.src=caps[i]; await new Promise(r=>img.onload=r); const pageW=pdf.internal.pageSize.getWidth(), pageH=pdf.internal.pageSize.getHeight(); const ratio=Math.min(pageW/img.width, pageH/img.height); const w=img.width*ratio, h=img.height*ratio; const x=(pageW-w)/2, y=(pageH-h)/2; if(i>0) pdf.addPage(); const type = caps[i].indexOf('image/png')!==-1 ? 'PNG' : 'JPEG'; pdf.addImage(caps[i], type, x, y, w, h); } pdf.save('scanned.pdf'); });</script></body></html>
