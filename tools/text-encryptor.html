<!doctype html><html><head><meta charset='utf-8'><meta name='viewport' content='width=device-width,initial-scale=1'><title>Text Encryptor</title>
<link rel='stylesheet' href='../style.css'><style>body{margin:0;padding:18px;font-family:Inter,Arial;color:#0b1220}textarea{width:100%;min-height:120px;padding:12px;border-radius:8px;border:1px solid #e6eef6}</style></head><body>
<div class='container'><h2>Text Encryptor (AES-GCM)</h2><p class='small'>Enter text and a passphrase. Encrypt/Decrypt in the browser using Web Crypto API.</p>
<textarea id='txt' placeholder='Secret message'></textarea>
<input id='pass' type='password' placeholder='Passphrase' style='width:100%;padding:10px;border-radius:8px;border:1px solid #e6eef6;margin-top:8px'>
<div style='margin-top:10px'><button class='btn' id='enc'>Encrypt</button> <button class='btn' id='dec'>Decrypt</button></div>
<pre id='out' style='margin-top:12px;background:#f1f5f9;padding:10px;border-radius:8px;white-space:pre-wrap'></pre>
</div>
<script>try{parent.postMessage({type:'activate', href:'tools/text-encryptor.html'}, location.origin);}catch(e){};async function getKey(pass){ const enc = new TextEncoder(); const keyMaterial = await window.crypto.subtle.importKey('raw', enc.encode(pass), {name:'PBKDF2'}, false, ['deriveKey']); return crypto.subtle.deriveKey({name:'PBKDF2', salt: enc.encode('toolmancer_salt'), iterations: 100000, hash: 'SHA-256'}, keyMaterial, {name:'AES-GCM', length: 256}, false, ['encrypt','decrypt']); }document.getElementById('enc').addEventListener('click', async ()=>{ const text = document.getElementById('txt').value; const pass = document.getElementById('pass').value; if(!text || !pass) return alert('Enter text and passphrase'); const key = await getKey(pass); const iv = crypto.getRandomValues(new Uint8Array(12)); const enc = new TextEncoder(); const ct = await crypto.subtle.encrypt({name:'AES-GCM', iv}, key, enc.encode(text)); const combined = new Uint8Array(iv.byteLength + ct.byteLength); combined.set(iv,0); combined.set(new Uint8Array(ct), iv.byteLength); const b64 = btoa(String.fromCharCode(...combined)); document.getElementById('out').textContent = b64; });document.getElementById('dec').addEventListener('click', async ()=>{ const b64 = document.getElementById('txt').value || document.getElementById('out').textContent; const pass = document.getElementById('pass').value; if(!b64 || !pass) return alert('Provide base64 (paste into text area) and correct passphrase'); try{ const data = Uint8Array.from(atob(b64), c => c.charCodeAt(0)); const iv = data.slice(0,12); const ct = data.slice(12); const key = await getKey(pass); const pt = await crypto.subtle.decrypt({name:'AES-GCM', iv}, key, ct); document.getElementById('out').textContent = new TextDecoder().decode(pt); }catch(e){ alert('Decryption failed (wrong passphrase or corrupt data)'); } });</script></body></html>